@{
    var busnies = ViewBag.Busnies as RezervasyonSistemi.Models.Busnies;
    var rezervasyonlar = ViewBag.Rezervasyonlar as List<RezervasyonSistemi.Models.Rezervasyon>;
    string initials = busnies != null && !string.IsNullOrEmpty(busnies.Ad) ? string.Join("", busnies.Ad.Split(' ').Select(x => x[0])).ToUpper() : "B";
}
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒ∞≈ületme Paneli - RezerveHub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        nav {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
            min-height: 80px;
            width: 100%;
            box-sizing: border-box;
            position: relative;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            color: white;
            text-decoration: none;
            letter-spacing: -1px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            flex-shrink: 0;
            margin-right: 2rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-width: 200px;
            flex-shrink: 0;
        }

        .profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

            .profile-pic:hover {
                transform: scale(1.1);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .profile-pic input {
                position: absolute;
                width: 100%;
                height: 100%;
                opacity: 0;
                cursor: pointer;
            }

            .profile-pic img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                border-radius: 50%;
            }

        .user-name {
            color: white;
            font-weight: 600;
            font-size: 1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            white-space: nowrap;
            flex-shrink: 0;
            min-width: 100px;
            text-align: center;
            display: inline-block;
            margin-left: 1rem;
        }

            .logout-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                transform: translateY(-2px);
            }

        .delete-account-btn {
            background: rgba(220, 53, 69, 0.8);
            border: 1px solid rgba(220, 53, 69, 0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            white-space: nowrap;
            flex-shrink: 0;
            min-width: 100px;
            text-align: center;
            display: inline-block;
            margin-left: 0.5rem;
        }

        .delete-account-btn:hover {
            background: rgba(220, 53, 69, 1);
            transform: translateY(-2px);
        }

        /* Account Deletion Modal Styles */
        .deletion-step {
            transition: all 0.3s ease;
        }

        .warning-icon, .success-icon, .final-warning-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            background: rgba(220, 53, 69, 0.1);
            border: 3px solid #dc3545;
        }

        .success-icon {
            background: rgba(13, 110, 253, 0.1);
            border-color: #0d6efd;
        }

        .final-warning-icon {
            background: rgba(220, 53, 69, 0.2);
            border-color: #dc3545;
            animation: pulse 2s infinite;
        }

        keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }

        .modal-content {
            border: none;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            border-radius: 15px 15px 0 0;
            border-bottom: none;
        }

        .form-control-lg {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .form-control-lg:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
        }

        .btn-lg {
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-lg:hover {
            transform: translateY(-2px);
        }

        /* Main Content */
        main {
            padding-top: 100px;
            max-width: 1400px;
            margin: 0 auto;
            padding-left: 2rem;
            padding-right: 2rem;
            padding-bottom: 2rem;
        }

        /* Responsive Header */
        media (max-width: 768px) {
            nav {
                padding: 1rem;
                min-height: 70px;
                justify-content: flex-start;
            }
            
            .logo {
                font-size: 1.5rem;
                flex-shrink: 0;
                margin-right: 1.5rem;
            }
            
            .user-profile {
                min-width: 150px;
                padding: 0.4rem 0.8rem;
                gap: 0.5rem;
                flex-shrink: 0;
            }
            
            .user-name {
                max-width: 80px;
                font-size: 0.9rem;
            }
            
            .logout-btn {
                min-width: 80px;
                padding: 0.4rem 0.8rem;
                font-size: 0.9rem;
                margin-left: 0.8rem;
            }
            
            .profile-pic {
                width: 35px;
                height: 35px;
                font-size: 1rem;
                flex-shrink: 0;
            }
        }

        media (max-width: 480px) {
            nav {
                padding: 0.8rem;
                min-height: 60px;
                justify-content: flex-start;
            }
            
            .logo {
                font-size: 1.3rem;
                flex-shrink: 0;
                margin-right: 1rem;
            }
            
            .user-profile {
                min-width: 120px;
                padding: 0.3rem 0.6rem;
                gap: 0.4rem;
                flex-shrink: 0;
            }
            
            .user-name {
                max-width: 60px;
                font-size: 0.8rem;
            }
            
            .logout-btn {
                min-width: 70px;
                padding: 0.3rem 0.6rem;
                font-size: 0.8rem;
                margin-left: 0.6rem;
            }
            
            .profile-pic {
                width: 30px;
                height: 30px;
                font-size: 0.9rem;
                flex-shrink: 0;
            }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease;
        }

            .card:hover {
                transform: translateY(-5px);
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            }

        .card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255, 107, 107, 0.1);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
        }

        /* New Service Form */
        .service-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            position: relative;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid rgba(255, 107, 107, 0.2);
            border-radius: 10px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

            .form-input:focus, .form-select:focus, .form-textarea:focus {
                outline: none;
                border-color: #ff6b6b;
                box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
                background: white;
            }

        .add-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 0.5rem;
        }

            .add-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
            }

        /* Reservations */
        .reservation-item {
            background: rgba(255, 107, 107, 0.05);
            border: 1px solid rgba(255, 107, 107, 0.2);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

            .reservation-item:hover {
                background: rgba(255, 107, 107, 0.1);
                transform: translateX(5px);
            }

        .reservation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .customer-name {
            font-weight: 600;
            color: #333;
        }

        .reservation-status {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d4edda;
            color: #155724;
        }

        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .reservation-details {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.8rem;
        }

        .reservation-actions {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            padding: 0.4rem 0.8rem;
            border: none;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .approve-btn {
            background: #28a745;
            color: white;
        }

            .approve-btn:hover {
                background: #218838;
                transform: translateY(-1px);
            }

        .reject-btn {
            background: #dc3545;
            color: white;
        }

            .reject-btn:hover {
                background: #c82333;
                transform: translateY(-1px);
            }

        .delete-btn {
            background: #ff6b6b;
            color: white;
        }

            .delete-btn:hover {
                background: #ee5a52;
                transform: translateY(-1px);
            }

        /* Profile Section */
        .profile-section {
            text-align: center;
        }

        .large-profile-pic {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            font-weight: bold;
            margin: 0 auto 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 4px solid rgba(255, 107, 107, 0.3);
        }

            .large-profile-pic:hover {
                transform: scale(1.05);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }

            .large-profile-pic input {
                position: absolute;
                width: 100%;
                height: 100%;
                opacity: 0;
                cursor: pointer;
            }

            .large-profile-pic img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                border-radius: 50%;
            }

        .business-info {
            margin-top: 1rem;
        }

        .business-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .business-details {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Full Width Section */
        .full-width-section {
            grid-column: 1 / -1;
        }

        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid rgba(255, 107, 107, 0.1);
        }

        .tab {
            padding: 0.8rem 1.5rem;
            background: none;
            border: none;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

            .tab.active {
                color: #ff6b6b;
                border-bottom-color: #ff6b6b;
            }

            .tab:hover {
                color: #ff6b6b;
            }

        .tab-content {
            display: none;
        }

            .tab-content.active {
                display: block;
            }

        .reservation-grid {
            display: grid;
            gap: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }

        /* Animations */
        keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive */
        media (max-width: 1024px) {
            .dashboard-grid

        {
            grid-template-columns: 1fr;
        }

        .form-row {
            grid-template-columns: 1fr;
        }

        }

        media (max-width: 768px) {
            main

        {
            padding-left: 1rem;
            padding-right: 1rem;
        }

        nav {
            padding: 1rem;
        }

        .user-profile {
            gap: 0.5rem;
        }

        .user-name {
            display: none;
        }

        }

        /* Empty states */
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: #666;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    @Html.AntiForgeryToken()
    <header>
        <nav>
            <a href="/" class="logo">RezerveHub</a>
            <div class="user-profile">
                <div class="profile-pic" id="headerProfilePic">
                    <input type="file" accept="image/*" id="headerProfileInput">
                    @if (!string.IsNullOrEmpty(busnies?.ProfilResmiUrl))
                    {
                        <img src="@busnies.ProfilResmiUrl" alt="Profil" />
                    }
                    else
                    {
                        <span id="headerInitials">@initials</span>
                    }
                </div>
                <span class="user-name" id="businessName">@busnies?.Ad</span>
                <div class="d-flex gap-2">
                    <form method="post" action="@Url.Action("Logout", "IsletmePanel")" style="display: inline;">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="logout-btn">üö™ √áƒ±kƒ±≈ü</button>
                    </form>
                    <button class="delete-account-btn" onclick="showDeleteAccountModal()">üóëÔ∏è Hesabƒ±mƒ± Sil</button>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div class="info-box" style="background:rgba(255,255,255,0.85);border-left:5px solid #ff6b6b;padding:1.2rem 2rem;margin-bottom:2rem;border-radius:14px;box-shadow:0 4px 24px rgba(0,0,0,0.06);display:flex;align-items:center;gap:1rem;">
            <span style="font-size:1.7rem;color:#ff6b6b;">‚ÑπÔ∏è</span>
            <div style="color:#333;font-size:1.08rem;font-weight:500;">
                ƒ∞lk i≈üleminizi eklediƒüinizde i≈ületme paneliniz aktif olarak kullanƒ±lmaya ba≈ülayacaktƒ±r.
            </div>
        </div>
        <div class="dashboard-grid">
            <!-- New Service Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">‚ûï</div>
                    <h2 class="card-title">Yeni Hizmet Ekle</h2>
                </div>
                <form class="service-form" onsubmit="addService(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" class="form-input" placeholder="Hizmet Adƒ±" required>
                        </div>
                        <div class="form-group">
                            <input type="number" class="form-input" placeholder="Fiyat (‚Ç∫)" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <input type="number" class="form-input" placeholder="S√ºre (dakika)" required>
                    </div>
                    <div class="form-group">
                        <textarea class="form-textarea" placeholder="Hizmet A√ßƒ±klamasƒ±"></textarea>
                    </div>
                    <button type="submit" class="add-btn">‚ú® Hizmet Ekle</button>
                </form>
            </div>

            <!-- Profile Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üë§</div>
                    <h2 class="card-title">ƒ∞≈ületme Profili</h2>
                </div>
                <div class="profile-section">
                    <div class="large-profile-pic" id="largeProfilePic">
                        <input type="file" accept="image/*" id="largeProfileInput">
                        @if (!string.IsNullOrEmpty(busnies?.ProfilResmiUrl))
                        {
                            <img src="@busnies.ProfilResmiUrl" alt="Profil" />
                        }
                        else
                        {
                            <span id="largeInitials">@initials</span>
                        }
                    </div>
                    <div class="business-info">
                        <h3 class="business-name">@busnies?.Ad</h3>
                        <div class="business-details">
                            üìç @busnies?.Adres<br>
                            üìß @busnies?.Email<br>
                            üìû @busnies?.Telefon<br>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pending Reservations -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">‚è≥</div>
                    <h2 class="card-title">Bekleyen Rezervasyonlar</h2>
                </div>
                <div class="reservation-grid" id="pendingReservations">
                    @if (rezervasyonlar != null && rezervasyonlar.Any(r => r.Durum == "Bekliyor"))
                    {
                        foreach (var r in rezervasyonlar.Where(r => r.Durum == "Bekliyor"))
                        {
                            <div class="reservation-item">
                                <div class="reservation-header">
                                    <span class="customer-name">@r.MusteriAdSoyad</span>
                                    <span class="reservation-status status-pending">Bekliyor</span>
                                </div>
                                <div class="reservation-details">
                                    üóìÔ∏è @r.Tarih.ToString("dd MMMM yyyy, dddd")<br>
                                    üïê @r.Saat<br>
                                    üõ†Ô∏è @r.HizmetAd
                                </div>
                                <div class="reservation-actions">
                                    <button class="action-btn approve-btn" onclick="updateReservationStatus(this, '@r.Id', 'Onaylandƒ±')">‚úÖ Onayla</button>
                                    <button class="action-btn reject-btn" onclick="updateReservationStatus(this, '@r.Id', 'ƒ∞ptal')">‚ùå Reddet</button>
                                    <button class="action-btn delete-btn" onclick="deleteReservation('@r.Id', '@r.MusteriAdSoyad')">üóëÔ∏è Sil</button>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="empty-state">
                            <div class="empty-state-icon">‚è≥</div>
                            <p>Bekleyen rezervasyon yok.</p>
                        </div>
                    }
                </div>
            </div>

            <!-- All Reservations -->
            <div class="card full-width-section">
                <div class="card-header">
                    <div class="card-icon">üìã</div>
                    <h2 class="card-title">T√ºm Rezervasyonlar</h2>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchTab(event, 'all')">T√ºm√º</button>
                    <button class="tab" onclick="switchTab(event, 'today')">Bug√ºn</button>
                    <button class="tab" onclick="switchTab(event, 'upcoming')">Yakla≈üan</button>
                    <button class="tab" onclick="switchTab(event, 'past')">Ge√ßmi≈ü</button>
                </div>

                <div class="tab-content active" id="all">
                    <div class="reservation-grid">
                        @if (rezervasyonlar != null && rezervasyonlar.Count > 0)
                        {
                            foreach (var r in rezervasyonlar)
                            {
                                <div class="reservation-item">
                                    <div class="reservation-header">
                                        <span class="customer-name">@r.MusteriAdSoyad</span>
                                        <span class="reservation-status @(r.Durum == "Onaylandƒ±" ? "status-approved" : r.Durum == "ƒ∞ptal" ? "status-rejected" : r.Durum == "Bekliyor" ? "status-pending" : "")">
                                            @(r.Durum == "Onaylandƒ±" ? "Onaylandƒ±" : r.Durum == "ƒ∞ptal" ? "Reddedildi" : r.Durum)
                                        </span>
                                    </div>
                                    <div class="reservation-details">
                                        üóìÔ∏è @r.Tarih.ToString("dd MMMM yyyy, dddd")<br>
                                        üïê @r.Saat<br>
                                        üõ†Ô∏è @r.HizmetAd
                                    </div>
                                    <div class="reservation-actions">
                                        <button class="action-btn delete-btn" onclick="deleteReservation('@r.Id', '@r.MusteriAdSoyad')">üóëÔ∏è Sil</button>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="empty-state">
                                <div class="empty-state-icon">üìã</div>
                                <p>Hen√ºz rezervasyon yok.</p>
                            </div>
                        }
                    </div>
                </div>

                <div class="tab-content" id="today">
                    <div class="reservation-grid">
                        @{
                            var todayReservations = rezervasyonlar?.Where(r => r.Tarih.Date == DateTime.Today.Date).ToList();
                        }
                        @if (todayReservations != null && todayReservations.Count > 0)
                        {
                            foreach (var r in todayReservations)
                            {
                                <div class="reservation-item">
                                    <div class="reservation-header">
                                        <span class="customer-name">@r.MusteriAdSoyad</span>
                                        <span class="reservation-status @(r.Durum == "Onaylandƒ±" ? "status-approved" : r.Durum == "ƒ∞ptal" ? "status-rejected" : r.Durum == "Bekliyor" ? "status-pending" : "")">
                                            @(r.Durum == "Onaylandƒ±" ? "Onaylandƒ±" : r.Durum == "ƒ∞ptal" ? "Reddedildi" : r.Durum)
                                        </span>
                                    </div>
                                    <div class="reservation-details">
                                        üóìÔ∏è @r.Tarih.ToString("dd MMMM yyyy, dddd")<br>
                                        üïê @r.Saat<br>
                                        üõ†Ô∏è @r.HizmetAd
                                    </div>
                                    <div class="reservation-actions">
                                        @if (r.Durum == "Bekliyor")
                                        {
                                            <button class="action-btn approve-btn" onclick="updateReservationStatus(this, '@r.Id', 'Onaylandƒ±')">‚úÖ Onayla</button>
                                            <button class="action-btn reject-btn" onclick="updateReservationStatus(this, '@r.Id', 'ƒ∞ptal')">‚ùå Reddet</button>
                                        }
                                        <button class="action-btn delete-btn" onclick="deleteReservation('@r.Id', '@r.MusteriAdSoyad')">üóëÔ∏è Sil</button>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="empty-state">
                                <div class="empty-state-icon">üìÖ</div>
                                <p>Bug√ºn i√ßin rezervasyon bulunmuyor.</p>
                            </div>
                        }
                    </div>
                </div>

                <div class="tab-content" id="upcoming">
                    <div class="reservation-grid">
                        @{
                            var upcomingReservations = rezervasyonlar?.Where(r => r.Tarih.Date > DateTime.Today.Date).ToList();
                        }
                        @if (upcomingReservations != null && upcomingReservations.Count > 0)
                        {
                            foreach (var r in upcomingReservations.OrderBy(r => r.Tarih))
                            {
                                <div class="reservation-item">
                                    <div class="reservation-header">
                                        <span class="customer-name">@r.MusteriAdSoyad</span>
                                        <span class="reservation-status @(r.Durum == "Onaylandƒ±" ? "status-approved" : r.Durum == "ƒ∞ptal" ? "status-rejected" : r.Durum == "Bekliyor" ? "status-pending" : "")">
                                            @(r.Durum == "Onaylandƒ±" ? "Onaylandƒ±" : r.Durum == "ƒ∞ptal" ? "Reddedildi" : r.Durum)
                                        </span>
                                    </div>
                                    <div class="reservation-details">
                                        üóìÔ∏è @r.Tarih.ToString("dd MMMM yyyy, dddd")<br>
                                        üïê @r.Saat<br>
                                        üõ†Ô∏è @r.HizmetAd
                                    </div>
                                    <div class="reservation-actions">
                                        @if (r.Durum == "Bekliyor")
                                        {
                                            <button class="action-btn approve-btn" onclick="updateReservationStatus(this, '@r.Id', 'Onaylandƒ±')">‚úÖ Onayla</button>
                                            <button class="action-btn reject-btn" onclick="updateReservationStatus(this, '@r.Id', 'ƒ∞ptal')">‚ùå Reddet</button>
                                        }
                                        <button class="action-btn delete-btn" onclick="deleteReservation('@r.Id', '@r.MusteriAdSoyad')">üóëÔ∏è Sil</button>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="empty-state">
                                <div class="empty-state-icon">‚è≥</div>
                                <p>Yakla≈üan rezervasyon bulunmuyor.</p>
                            </div>
                        }
                    </div>
                </div>

                <div class="tab-content" id="past">
                    <div class="reservation-grid">
                        @{
                            var pastReservations = rezervasyonlar?.Where(r => r.Tarih.Date < DateTime.Today.Date).ToList();
                        }
                        @if (pastReservations != null && pastReservations.Count > 0)
                        {
                            foreach (var r in pastReservations.OrderByDescending(r => r.Tarih))
                            {
                                <div class="reservation-item">
                                    <div class="reservation-header">
                                        <span class="customer-name">@r.MusteriAdSoyad</span>
                                        <span class="reservation-status @(r.Durum == "Onaylandƒ±" ? "status-approved" : r.Durum == "ƒ∞ptal" ? "status-rejected" : r.Durum == "Bekliyor" ? "status-pending" : "")">
                                            @(r.Durum == "Onaylandƒ±" ? "Onaylandƒ±" : r.Durum == "ƒ∞ptal" ? "Reddedildi" : r.Durum)
                                        </span>
                                    </div>
                                    <div class="reservation-details">
                                        üóìÔ∏è @r.Tarih.ToString("dd MMMM yyyy, dddd")<br>
                                        üïê @r.Saat<br>
                                        üõ†Ô∏è @r.HizmetAd
                                    </div>
                                    <div class="reservation-actions">
                                        <button class="action-btn delete-btn" onclick="deleteReservation('@r.Id', '@r.MusteriAdSoyad')">üóëÔ∏è Sil</button>
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="empty-state">
                                <div class="empty-state-icon">üìö</div>
                                <p>Ge√ßmi≈ü rezervasyon bulunmuyor.</p>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Hizmetler (Eski Hizmetler) Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üõ†Ô∏è</div>
                    <h2 class="card-title">Hizmetlerim</h2>
                </div>
                <div>
                    @if (busnies?.Hizmetler != null && busnies.Hizmetler.Count > 0)
                    {
                        <ul class="list-group mb-3">
                        @foreach (var h in busnies.Hizmetler)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="fw-semibold">@h.Ad</span>
                                    <span class="text-muted small ms-2">(@h.Sure dk)</span>
                                </div>
                                <div>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteService('@h.Ad', this)">Sil</button>
                                </div>
                            </li>
                        }
                        </ul>
                    }
                    else
                    {
                        <div class="empty-state">
                            <div class="empty-state-icon">üõ†Ô∏è</div>
                            <p>Hen√ºz hizmet eklenmemi≈ü.</p>
                        </div>
                    }
                </div>
            </div>


        </div>
    </main>

    <!-- Hesap Silme Modalƒ± (Rezervasyon/Index.cshtml ile aynƒ± tasarƒ±m) -->
    <div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-labelledby="deleteAccountModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="deleteAccountModalLabel">
                        <i class="fas fa-exclamation-triangle me-2"></i>Hesap Silme
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="step1" class="deletion-step">
                        <div class="text-center mb-4">
                            <div class="warning-icon mb-3">
                                <i class="fas fa-user-times fa-3x text-danger"></i>
                            </div>
                            <h4 class="text-danger">ƒ∞≈ületme Hesabƒ±nƒ±zƒ± Silmek ƒ∞stiyor musunuz?</h4>
                            <p class="text-muted">Bu i≈ülem geri alƒ±namaz ve t√ºm verileriniz kalƒ±cƒ± olarak silinecektir.</p>
                        </div>
                        <div class="alert alert-warning">
                            <h6><i class="fas fa-exclamation-triangle me-2"></i>Dikkat!</h6>
                            <ul class="mb-0">
                                <li>T√ºm rezervasyonlarƒ±nƒ±z silinecek</li>
                                <li>Profil bilgileriniz kalƒ±cƒ± olarak silinecek</li>
                                <li>Bu i≈ülem geri alƒ±namaz</li>
                            </ul>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="confirmDeletion">
                            <label class="form-check-label" for="confirmDeletion">
                                ƒ∞≈ületme hesabƒ±mƒ± silmek istediƒüimi anlƒ±yorum ve bu i≈ülemin geri alƒ±namaz olduƒüunu kabul ediyorum
                            </label>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-danger" onclick="requestDeletion()" id="requestDeletionBtn" disabled>
                                <i class="fas fa-paper-plane me-2"></i>Doƒürulama Kodu G√∂nder
                            </button>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="fas fa-times me-2"></i>ƒ∞ptal
                            </button>
                        </div>
                    </div>
                    <div id="step2" class="deletion-step" style="display: none;">
                        <div class="text-center mb-4">
                            <div class="success-icon mb-3">
                                <i class="fas fa-envelope fa-3x text-primary"></i>
                            </div>
                            <h4 class="text-primary">Doƒürulama Kodu G√∂nderildi</h4>
                            <p class="text-muted">E-posta adresinize 6 haneli doƒürulama kodu g√∂nderildi.</p>
                        </div>
                        <div class="mb-3">
                            <label for="verificationCode" class="form-label">Doƒürulama Kodu</label>
                            <input type="text" class="form-control form-control-lg text-center" id="verificationCode" maxlength="6" placeholder="000000" style="letter-spacing: 0.5em; font-size: 1.2rem;">
                        </div>
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-primary" onclick="verifyDeletion()" id="verifyDeletionBtn">
                                <i class="fas fa-check me-2"></i>Doƒürula
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="backToStep1()">
                                <i class="fas fa-arrow-left me-2"></i>Geri
                            </button>
                        </div>
                    </div>
                    <div id="step3" class="deletion-step" style="display: none;">
                        <div class="text-center mb-4">
                            <div class="final-warning-icon mb-3">
                                <i class="fas fa-exclamation-triangle fa-3x text-danger"></i>
                            </div>
                            <h4 class="text-danger">Son Uyarƒ±!</h4>
                            <p class="text-muted">Doƒürulama ba≈üarƒ±lƒ±. ƒ∞≈ületme hesabƒ±nƒ±zƒ± kalƒ±cƒ± olarak silmek √ºzeresiniz.</p>
                        </div>
                        <div class="alert alert-danger">
                            <h6><i class="fas fa-skull-crossbones me-2"></i>Bu ƒ∞≈ülem Geri Alƒ±namaz!</h6>
                            <p class="mb-0">T√ºm verileriniz ve rezervasyonlarƒ±nƒ±z kalƒ±cƒ± olarak silinecektir.</p>
                        </div>
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-danger btn-lg" onclick="confirmDeletion()" id="confirmDeletionBtn">
                                <i class="fas fa-trash me-2"></i>ƒ∞≈ületme Hesabƒ±mƒ± Kalƒ±cƒ± Olarak Sil
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="backToStep1()">
                                <i class="fas fa-times me-2"></i>ƒ∞ptal Et
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Geri/ileri tu≈ülarƒ±yla eri≈üimi engelle
        window.history.pushState(null, null, window.location.href);
        window.onpopstate = function () {
            window.history.pushState(null, null, window.location.href);
            // Kullanƒ±cƒ±yƒ± uyar
            alert('Geri/ileri tu≈ülarƒ± kullanƒ±lamaz. L√ºtfen men√ºden navigasyon yapƒ±n.');
        };

        // Sayfa y√ºklendiƒüinde history'yi temizle
        window.addEventListener('load', function() {
            // Sayfa y√ºklendiƒüinde history'yi temizle
            if (window.history && window.history.pushState) {
                window.history.pushState(null, null, window.location.href);
            }
        });

        // √áƒ±kƒ±≈ü butonunu d√ºzelt
        document.addEventListener('DOMContentLoaded', function() {
            const logoutForm = document.querySelector('form[action*="Logout"]');
            if (logoutForm) {
                logoutForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    if (confirm('√áƒ±kƒ±≈ü yapmak istediƒüinizden emin misiniz?')) {
                        this.submit();
                    }
                });
            }
        });
        // Profil resmi y√ºkleme (header ve profil kartƒ± i√ßin ortak)
        function setupProfilePicUpload(inputId, displayId, initialsId) {
            const input = document.getElementById(inputId);
            const display = document.getElementById(displayId);
            const initials = document.getElementById(initialsId);
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const formData = new FormData();
                    formData.append('profilResmi', file);
                    fetch('/IsletmePanel/ProfilResmiYukle', {
                        method: 'POST',
                        body: formData
                    })
                    .then(r => r.json())
                    .then(res => {
                        if (res.success && res.url) {
                            // T√ºm profil resimlerini g√ºncelle
                            document.querySelectorAll('.profile-pic img, .large-profile-pic img').forEach(img => img.src = res.url);
                            // Eƒüer img yoksa, ekle
                            document.querySelectorAll('.profile-pic, .large-profile-pic').forEach(div => {
                                if (!div.querySelector('img')) {
                                    const img = document.createElement('img');
                                    img.src = res.url;
                                    div.innerHTML = '';
                                    div.appendChild(img);
                                    div.appendChild(input);
                                }
                            });
                        } else {
                            alert(res.message || 'Y√ºkleme ba≈üarƒ±sƒ±z!');
                        }
                    });
                }
            });
        }

        // Initialize profile picture uploads
        setupProfilePicUpload('headerProfileInput', 'headerProfilePic', 'headerInitials');
        setupProfilePicUpload('largeProfileInput', 'largeProfilePic', 'largeInitials');

        // Add new service
        function addService(event) {
            event.preventDefault();
            const form = event.target;
            const inputs = form.querySelectorAll('.form-input, .form-select, .form-textarea');
            const data = new URLSearchParams();
            data.append('ad', inputs[0].value);
            data.append('sure', inputs[2].value);
            
            // CSRF token al
            const token = document.querySelector('input[name="__RequestVerificationToken"]').value;
            data.append('__RequestVerificationToken', token);
            
            // Gerekirse diƒüer alanlar da eklenebilir (fiyat, kategori, a√ßƒ±klama)
            fetch('/IsletmePanel/HizmetEkle', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: data
            })
            .then(r => r.json())
            .then(res => {
                if (res.success) {
                    location.reload();
                } else {
                    alert(res.message || 'Hizmet eklenemedi!');
                }
            });
        }

        // Reservation actions
        function updateReservationStatus(button, rezervasyonId, yeniDurum) {
            button.disabled = true;
            
            // CSRF token al
            const token = document.querySelector('input[name="__RequestVerificationToken"]').value;
            
            fetch('/IsletmePanel/RezervasyonDurumGuncelle', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: 'rezervasyonId=' + encodeURIComponent(rezervasyonId) + '&yeniDurum=' + encodeURIComponent(yeniDurum) + '&__RequestVerificationToken=' + encodeURIComponent(token)
            })
            .then(r => r.json())
            .then(res => {
                if (res.success) {
                    // Ba≈üarƒ±yla g√ºncellendi, sayfayƒ± yenile veya kartƒ± g√ºncelle
                    location.reload();
                } else {
                    alert('Durum g√ºncellenemedi: ' + (res.message || 'Hata'));
                    button.disabled = false;
                }
            });
        }

        // Tab switching
        function switchTab(event, tabName) {
            // Remove active class from all tabs and content
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Logout function - Artƒ±k form ile yapƒ±lƒ±yor, bu fonksiyon kullanƒ±lmƒ±yor
        function logout() {
            if (confirm('√áƒ±kƒ±≈ü yapmak istediƒüinizden emin misiniz?')) {
                // Form submit edilecek
                document.querySelector('form[action*="Logout"]').submit();
            }
        }

        // Initialize animations
        document.addEventListener('DOMContentLoaded', function() {
            // Animate cards on load
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });

            // Update time every minute
            setInterval(updateTime, 60000);
        });

        function updateTime() {
            const now = new Date();
            const timeElements = document.querySelectorAll('.current-time');
            const timeString = now.toLocaleTimeString('tr-TR', {
                hour: '2-digit',
                minute: '2-digit'
            });

            timeElements.forEach(element => {
                element.textContent = timeString;
            });
        }

        // Real-time notifications (simulation)
        setInterval(() => {
            if (Math.random() < 0.1) { // 10% chance every 30 seconds
                showNotification('Yeni rezervasyon talebi geldi! üîî');
            }
        }, 30000);

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: linear-gradient(135deg, #ff6b6b, #ee5a52);
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                animation: slideInRight 0.5s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Add CSS for notification animation
        const style = document.createElement('style');
        style.textContent = `
            keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);

        // Hizmet silme
        function deleteService(ad, btn) {
            if (!confirm('Bu hizmeti silmek istediƒüinize emin misiniz?')) return;
            btn.disabled = true;
            
            // CSRF token al
            const token = document.querySelector('input[name="__RequestVerificationToken"]').value;
            
            fetch('/IsletmePanel/HizmetSil', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: 'hizmetId=' + encodeURIComponent(ad) + '&__RequestVerificationToken=' + encodeURIComponent(token)
            })
            .then(r => r.json())
            .then(res => {
                if (res.success) {
                    btn.closest('li').remove();
                } else {
                    alert('Silinemedi: ' + (res.message || 'Hata'));
                    btn.disabled = false;
                }
            });
        }

        // Rezervasyon silme fonksiyonu
        function deleteReservation(reservationId, customerName) {
            if (confirm(`"${customerName}" adƒ±na yapƒ±lan rezervasyonu silmek istediƒüinizden emin misiniz?`)) {
                // CSRF token al
                const token = document.querySelector('input[name="__RequestVerificationToken"]').value;
                
                fetch('/IsletmePanel/RezervasyonSil', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: 'rezervasyonId=' + encodeURIComponent(reservationId) + '&__RequestVerificationToken=' + encodeURIComponent(token)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Rezervasyon ba≈üarƒ±yla silindi.');
                        location.reload();
                    } else {
                        alert('Hata: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Bir hata olu≈ütu. L√ºtfen tekrar deneyin.');
                });
            }
        }

        // Modalƒ± a√ß
        function showDeleteAccountModal() {
            const modal = new bootstrap.Modal(document.getElementById('deleteAccountModal'));
            modal.show();
            // Reset modal state
            document.getElementById('confirmDeletion').checked = false;
            document.getElementById('requestDeletionBtn').disabled = true;
            document.getElementById('verificationCode').value = '';
            showStep(1);
        }
        function showStep(stepNumber) {
            document.querySelectorAll('.deletion-step').forEach(step => {
                step.style.display = 'none';
            });
            document.getElementById(`step${stepNumber}`).style.display = 'block';
        }
        document.getElementById('confirmDeletion').addEventListener('change', function() {
            document.getElementById('requestDeletionBtn').disabled = !this.checked;
        });
        document.getElementById('verificationCode').addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '').substring(0, 6);
        });
        function requestDeletion() {
            const email = '@(busnies?.Email ?? "")';
            const userType = 'business';
            fetch('/AccountDeletion/RequestDeletion', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: email, userType: userType })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showStep(2);
                } else {
                    alert('Hata: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Bir hata olu≈ütu. L√ºtfen tekrar deneyin.');
            });
        }
        function verifyDeletion() {
            const email = '@(busnies?.Email ?? "")';
            const verificationCode = document.getElementById('verificationCode').value;
            if (verificationCode.length !== 6) {
                alert('L√ºtfen 6 haneli doƒürulama kodunu girin.');
                return;
            }
            fetch('/AccountDeletion/VerifyDeletion', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: email, verificationCode: verificationCode })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showStep(3);
                } else {
                    alert('Hata: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Bir hata olu≈ütu. L√ºtfen tekrar deneyin.');
            });
        }
        function confirmDeletion() {
            const email = '@(busnies?.Email ?? "")';
            if (confirm('ƒ∞≈ületme hesabƒ±nƒ±zƒ± kalƒ±cƒ± olarak silmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz!')) {
                fetch('/AccountDeletion/ConfirmDeletion', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: email })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('ƒ∞≈ületme hesabƒ±nƒ±z ba≈üarƒ±yla silindi.');
                        if (data.redirectUrl) {
                            window.location.href = data.redirectUrl;
                        }
                    } else {
                        alert('Hata: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Bir hata olu≈ütu. L√ºtfen tekrar deneyin.');
                });
            }
        }
        function backToStep1() {
            showStep(1);
            document.getElementById('verificationCode').value = '';
        }
    </script>
</body>
</html>